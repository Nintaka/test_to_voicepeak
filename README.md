# VOICEPEAK Transmit (Monitor & Emotions)

VOICEPEAKで生成した音声を、仮想オーディオデバイス経由でDiscordのマイク入力として送信しつつ、自分自身でも同時にモニター（試聴）できるデスクトップアプリケーションです。
最新のバージョンでは、ナレーターごとの感情調整にも対応しています。

## 主な機能

- **Discord送信**: 仮想デバイス（VB-CABLE等）へ音声を送信。
- **同時モニター**: 自分自身のスピーカーやヘッドホンからも同時に音声を再生。
- **感情調整**: ナレーターが持つ感情パラメータをスライダーで直感的に調整可能。
- **ナレーター自動取得**: インストールされているナレーター一覧を自動でリストアップ。
- **パス自動検知**: VOICEPEAKのインストールパスを自動的に探索。

## 前提条件

1. **VOICEPEAK**: インストールされており、CLI（`voicepeak.exe`）が利用可能であること。
2. **仮想オーディオデバイス**: [VB-CABLE](https://vb-audio.com/Cable/) 等の仮想ケーブルソフトがインストールされていること。
3. **Python 3.x**: インストールされていること。

## セットアップ手順

### 1. 仮想環境の作成と有効化

プロジェクトのルートディレクトリで以下のコマンドを実行します。

```powershell
# 仮想環境の作成
python -m venv .venv

# 有効化 (PowerShell)
.\.venv\Scripts\Activate.ps1
```

### 2. ライブラリのインストール

```powershell
pip install sounddevice soundfile numpy
```

## 使い方

### 1. アプリの起動

```powershell
python app.py
```

### 2. アプリの設定

1. **送信先デバイス**: 「更新」ボタンを押し、**「CABLE Input (VB-Audio Virtual Cable)」** 等を選択します。
2. **自分でも聞く**: チェックを入れると、指定したデバイスから自分にも音が聞こえます。
3. **ナレーター名**: プルダウンから使用したいキャラを選択します。
4. **感情調整**: スライダーを動かして感情の配合を調整します（「感情リセット」で0に戻せます）。

### 3. 送信して再生

1. テキストボックスにメッセージを入力します。
2. **Enterキー** または **「送信して再生」ボタン** を押すと、音声が生成・再生されます。

## Discord側の設定

1. Discordの「ユーザー設定」>「音声・ビデオ」を開きます。
2. **入力デバイス** を **「CABLE Output (VB-Audio Virtual Cable)」** に変更します。
3. 必要に応じて「ノイズ抑制」や「入力感度」を調整してください。

## トラブルシューティング

- **デバイスが見つからない**: アプリの「更新」ボタンを押し忘れていないか確認してください。
- **音が聞こえない**: モニター用のデバイス設定が正しいスピーカーになっているか確認してください。
- **VOICEPEAKエラー**: 指定したパスに `voicepeak.exe` が存在するか確認してください。
